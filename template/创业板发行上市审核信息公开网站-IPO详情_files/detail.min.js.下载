!function(){"use strict";var n,t=window.location.pathname;0<=t.indexOf("ipo")?n=1:0<=t.indexOf("refinance")?n=2:0<=t.indexOf("reproperty")&&(n=3);var o={"注册审核":"首","再融资":"融","并购重组":"并",IPO:"首","重大资产重组":"重"};function a(t){var a=_.template($('script[id="project-detail-template"]').html())(t),e=$(".project-detail-con");e.empty(),e.append(a)}var e,d={45:"通过",44:"未通过",46:"暂缓审议",56:"复审通过",54:"复审不通过"},r=window.location.search.split("?id=")[1];(e=+r,$.get(pathObj.ras_domain_path_http+"/api/ras/projectrends/details?id="+e+"&r="+Math.random())).then(function(r){if(r&&r.data){if(r.data.biztype==n){r.data.biztyp=o[r.data.biztyp],r.data.jsprinstList=r.data.jsprinst?r.data.jsprinst.split("，"):[],r.data.othersAttachment=[],_.each(r.data.others,function(t,a){_.each(t,function(t,a){r.data.othersAttachment.push({date:a,reason:t})})}),r.data.othersAttachment=_.sortBy(r.data.othersAttachment,function(t){return-new Date(t.date.replace(/-/g,"/"))}),r.downLoadHttp=pathObj.report_file_path;var t=_.groupBy(r.data.disclosureMaterials,"matnm"),s=[];_.each(t,function(t,a){var e=_.groupBy(t,"dtyp");for(var n in e)e[n]=_.sortBy(e[n],function(t){return t.dfid});e.matnm=a,e.matidx=t.matidx,s.push(e)}),s=_.sortBy(s,"matidx"),r.data.disclosureMaterials=s;var i=_.filter(r.data.prjprogs,function(t,a){return-1==t.orderNo})[0],a=_.filter(r.data.prjprogs,function(t,a){return-1!=t.orderNo}),e=_.sortBy(a,"orderNo");return r.data.flowLen=e.length,e.map(function(a,e){if(a.startTime=a.date?a.date.split(" ")[0]:"",a.name=a.caption,a.status&&0<a.status.length){_.forEach(a.status,function(t){t.name=t.caption});var t=_.sortBy(a.status,"orderNo");if(36==a.value||40==a.value||70==a.value){var n=t[t.length-1];n.style="other-style",n.name=d[n.value]||n.name,a.data=[n]}}0==a.stageType?a.style="finished":1==a.stageType?(a.style="dealing",i&&(i.name=i.caption,i.startTime=i.date?i.date.split(" ")[0]:"",a.data||(a.data=[]),80!=i.value&&(a.data=[i]),80==i.value&&a.data.push(i),a.data.forEach(function(t){"80"==t.value?(t.style="suspend",e==r.data.flowLen-1&&(r.data.flowLen+=1)):(t.style="other-style",40==a.value||36==a.value||70==a.value||80==a.value?t.name=d[t.value]||t.name:t.name="")}))):2==a.stageType&&(a.style="pengding"),"终止"==a.name&&(a.style="termination")}),r.data.isShowCashReorganization=3==r.data.biztype&&32==r.data.biztypsb&&1==r.data.isCashPurchase,r.data.prjprogs=e,r}owsModal.message({type:"info",message:"当前项目类型找不到匹配的数据，请通过项目列表重新获取！"})}else owsModal.message({type:"info",message:"找不到匹配的数据！"})}).then(a),$(".g-banner-txt p").hide()}();